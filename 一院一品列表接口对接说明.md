# 一院一品列表接口对接说明

## 完成内容

### 1. 创建 API 接口文件
**文件位置**: `src/api/college.ts`

包含以下接口函数：
- `getCollegePageList()` - 分页查询列表（已实现）
- `addCollege()` - 新增数据（预留）
- `updateCollege()` - 更新数据（预留）
- `deleteCollege()` - 删除数据（预留）
- `updateCollegeSort()` - 批量更新排序（预留）

### 2. 接口参数说明

#### 请求参数 (CollegePageParams)
```typescript
{
  pageIndex: number    // 页码，默认1（必需）
  pageSize: number     // 每页大小，默认10条（必需）
  keyword?: string     // 搜索关键词（可选）
  showFront?: number   // 显示状态：1=显示；0=隐藏；不传显示所有（可选）
  college?: string     // 所在学院（可选）
}
```

#### 响应数据格式
```typescript
{
  code: 200,
  msg: "消息",
  data: {
    records: [],      // 数据列表
    total: 0,         // 总数
    size: 10,         // 每页大小
    current: 1,       // 当前页码
    pages: 0          // 总页数
  }
}
```

### 3. 页面功能实现
**文件位置**: `src/views/admin/Resources/CollegeSpecial.vue`

#### 已实现功能：
✅ **分页查询** - 页面加载时自动调用 `/college/page/list` 接口获取数据
✅ **搜索功能** - 支持按标题关键词搜索，触发重新查询
✅ **状态筛选** - 支持按显示状态筛选（全部/显示中/已隐藏）
✅ **分页切换** - 使用 Pagination 组件实现页码切换
✅ **每页数量切换** - 支持切换每页显示条数（10/20/50/100）
✅ **加载状态** - 显示加载动画，优化用户体验

#### 主要改动：
1. **导入依赖**
   - 引入 `getCollegePageList` API 函数
   - 引入 `Pagination` 分页组件

2. **数据管理**
   - 使用真实 API 数据替代模拟数据
   - 添加 `loading` 状态管理
   - 添加 `pagination` 分页状态管理

3. **核心函数**
   - `loadData()` - 加载数据主函数
   - `handleSearch()` - 搜索处理（重置到第一页）
   - `handleFilter()` - 筛选处理（重置到第一页）
   - `handlePageChange()` - 页码切换
   - `handleSizeChange()` - 每页数量切换

4. **UI 改进**
   - 添加加载动画（旋转圆圈）
   - 分页组件集成
   - 数据统计显示总条数

### 4. 实际数据字段说明

根据 API 实际返回的数据结构，`records` 数组中每条数据包含以下字段：

| 字段名 | 类型 | 说明 |
|--------|------|------|
| `id` | number | 业务id（必需）|
| `name` | string | 课程名称（必需）|
| `coverUrl` | string | 封面图片 URL（必需）|
| `college` | string | 所在学院（必需）|
| `teachers` | array[string] | 主讲教师，多个（必需）|
| `types` | array[string] | 建设课程类型，多个（必需）|
| `content` | string | 课程详细内容（必需）|
| `statPv` | number | 浏览量（必需）|
| `showFront` | number | 是否前台显示：1=显示；0=隐藏（必需）|
| `createTime` | string | 发布时间（必需）|

**数据示例：**
```json
{
  "id": 1,
  "name": "新时代中国特色社会主义思想融入专业课程实践",
  "coverUrl": "https://example.com/image.jpg",
  "college": "计算机学院",
  "teachers": ["张教授", "李教授"],
  "types": ["专业必修课程", "实践课程"],
  "content": "课程详细内容...",
  "statPv": 1234,
  "showFront": 1,
  "createTime": "2024-11-20 10:30:00"
}
```

### 5. 筛选逻辑说明

```javascript
// 状态筛选映射
statusFilter.value === 'active'   → showFront: 1  (显示中)
statusFilter.value === 'inactive' → showFront: 0  (已隐藏)
statusFilter.value === 'all'      → 不传 showFront (显示所有)
```

### 6. 使用方法

#### 基本使用
页面加载后会自动调用 API 获取第一页数据（每页10条）

#### 搜索
在搜索框输入关键词，实时触发搜索（重置到第一页）

#### 筛选
选择状态下拉框，触发筛选（重置到第一页）

#### 翻页
- 点击页码切换到对应页
- 点击"上一页"/"下一页"按钮
- 选择每页显示条数

### 7. 注意事项

1. **API 响应格式**
   - 接口返回的数据结构需要符合 `PageResponse<CollegeItem>` 类型
   - `showFront` 字段值：1 表示显示，0 表示隐藏

2. **其他功能（待实现）**
   以下功能已预留接口但未实际调用，需要后续实现：
   - 新增数据（需调用 `addCollege` API）
   - 编辑数据（需调用 `updateCollege` API）
   - 删除数据（需调用 `deleteCollege` API）
   - 拖拽排序（需调用 `updateCollegeSort` API）

3. **数组字段处理**
   - `teachers` 和 `types` 字段在表单中使用顿号（、）分隔的字符串输入
   - 保存时会自动转换为数组格式
   - 显示时会自动用顿号连接显示
   
4. **数据类型对应**
   ```typescript
   // 页面中的 status → API 中的 showFront
   status: 'active'   → showFront: 1
   status: 'inactive' → showFront: 0
   ```

### 8. 测试建议

1. 打开页面，检查是否自动加载数据
2. 测试搜索功能：输入关键词，查看结果
3. 测试筛选功能：切换状态下拉框
4. 测试分页：切换页码和每页条数
5. 检查浏览器控制台，查看 API 请求和响应日志

## 技术栈
- Vue 3 Composition API
- TypeScript
- Axios
- 自定义 Pagination 组件

## 相关文件
- `src/api/college.ts` - API 接口定义
- `src/api/index.ts` - API 统一导出
- `src/views/admin/Resources/CollegeSpecial.vue` - 页面组件
- `src/components/common/Pagination/index.vue` - 分页组件

